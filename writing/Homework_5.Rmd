---
title: "Homework_5"
author: "Owen Bevis"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

### Load libraries
```{r}
library(tidyverse)
library(tigris)
library(viridis)
library(forcats)
```

### Load data and pick city
```{r}
homicides <- read_csv("../data/homicide-data.csv") %>% 
  filter(city == "Louisville")
```

### Use Tigris to download sub-city information as sf objects.
```{r}
L_tracts <- tracts(state = "KY", 
                   county = "Jefferson", 
                   class = "sf")

L_block_groups <- block_groups(state = "KY", 
                               county = "Jefferson", 
                               class = "sf")

L_county_sub <- county_subdivisions(state = "KY", 
                                    county = "Jefferson", 
                                    class = "sf")
```

### Reorder homicides data 
```{r}
homicides <- homicides %>% 
  mutate(victim_race = factor(victim_race, 
                              levels = c("White", "Black", "Hispanic", "Asian", "Other"))) %>% 
  mutate(victim_race = fct_lump_n(victim_race, n = 3))
```


### Create the plot
```{r}
ggplot() +
  geom_sf(data = L_tracts) +
  geom_sf(data = L_block_groups) +
  geom_sf(data = L_county_sub) +
  geom_point(data = homicides, 
             aes(x = lon, y = lat, color = victim_race), 
             alpha = 0.3) +
  #scale_color_viridis(name = "test") +
  theme(legend.position = "top") +
  facet_wrap(~ disposition) +
  theme_dark()
```

